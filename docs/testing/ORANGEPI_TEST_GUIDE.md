# Orange Pi 3B GUI æµ‹è¯•æŒ‡å—

## è®¾å¤‡ä¿¡æ¯
- **å‹å·**: Orange Pi 3B
- **SoC**: Rockchip RK3566
- **GPU**: Mali-G52
- **æ˜¾ç¤º**: X11 (modesetting é©±åŠ¨)

---

## ğŸ“‹ æµ‹è¯•å‰å‡†å¤‡

### 1. å®‰è£…ç³»ç»Ÿä¾èµ–

```bash
sudo apt-get update
sudo apt-get install -y \
    libsdl2-2.0-0 \
    libsdl2-image-2.0-0 \
    libsdl2-ttf-2.0-0 \
    python3 \
    python3-pip \
    git
```

### 2. å®‰è£… uv (Python åŒ…ç®¡ç†å™¨)

```bash
curl -LsSf https://astral.sh/uv/install.sh | sh
source $HOME/.cargo/env
```

### 3. å…‹éš†ä»£ç 

```bash
cd ~
git clone https://github.com/cuihuir/tope_updater.git
cd tope_updater
git checkout 002-gui
```

### 4. å®‰è£… Python ä¾èµ–

```bash
uv sync
```

---

## ğŸ§ª æµ‹è¯•æ­¥éª¤

### æµ‹è¯• 1: çª—å£æ¨¡å¼ï¼ˆæ¨èå…ˆæµ‹è¯•ï¼‰

```bash
# ç¡®ä¿ X11 è¿è¡Œ
export DISPLAY=:1  # æ ¹æ®æ‚¨çš„ startx è¾“å‡ºè°ƒæ•´

# è¿è¡Œçª—å£æ¨¡å¼æµ‹è¯•
uv run python test_orangepi_1920x440.py
```

**é¢„æœŸç»“æœ**:
- âœ… çª—å£æ˜¾ç¤ºåœ¨å±å¹•ä¸Š
- âœ… Logo æ˜¾ç¤ºæ¸…æ™°ï¼ˆ100x100 æˆ–æ ¹æ®åˆ†è¾¨ç‡ï¼‰
- âœ… ä¸­æ–‡æ–‡å­—æ­£å¸¸æ˜¾ç¤º
- âœ… è¿›åº¦æ¡å¹³æ»‘æ›´æ–°
- âœ… å¸ƒå±€åˆç†ï¼ˆLogo å·¦ä¾§ï¼Œå†…å®¹å³ä¾§ï¼‰

**è¾“å‡ºç¤ºä¾‹**:
```
============================================================
Orange Pi 3B GUI æµ‹è¯•
ç›®æ ‡åˆ†è¾¨ç‡: 1920x440
============================================================

åˆ›å»ºçª—å£...
âœ“ çª—å£åˆ›å»ºæˆåŠŸ
  - å±å¹•å°ºå¯¸: 1920x1080
  - Logo å°ºå¯¸: 120x120
  - å­—ä½“å¤§å°: 42px / 32px
  - è¿›åº¦æ¡å®½åº¦: 1000px

å¼€å§‹æ¨¡æ‹Ÿå‡çº§è¿›åº¦ï¼ˆ10ç§’ï¼‰...
è¯·è§‚å¯Ÿçª—å£æ˜¾ç¤ºæ•ˆæœ

  [  0%] æ­£åœ¨åˆå§‹åŒ–...
  [ 10%] æ­£åœ¨ä¸‹è½½æ›´æ–°åŒ…...
  ...
```

---

### æµ‹è¯• 2: å…¨å±æ¨¡å¼

```bash
# è¿è¡Œå…¨å±æ¨¡å¼æµ‹è¯•
uv run python test_orangepi_fullscreen.py
```

**é¢„æœŸç»“æœ**:
- âœ… å…¨å±è¦†ç›–æ•´ä¸ªå±å¹•
- âœ… çª—å£åœ¨æœ€å‰é¢
- âœ… æ‰€æœ‰å†…å®¹æ­£å¸¸æ˜¾ç¤º

**æ³¨æ„**: æŒ‰ Ctrl+C å¯ä»¥ä¸­æ–­æµ‹è¯•

---

### æµ‹è¯• 3: å®Œæ•´ OTA æµç¨‹ï¼ˆå¯é€‰ï¼‰

```bash
# 1. å¯åŠ¨ updater æœåŠ¡
uv run python src/updater/main.py &

# 2. ç­‰å¾…æœåŠ¡å¯åŠ¨
sleep 3

# 3. æ£€æŸ¥æœåŠ¡çŠ¶æ€
curl http://localhost:12315/api/v1.0/progress

# 4. è§¦å‘æ›´æ–°ï¼ˆéœ€è¦å‡†å¤‡æµ‹è¯•åŒ…ï¼‰
curl -X POST http://localhost:12315/api/v1.0/update \
  -H "Content-Type: application/json" \
  -d '{"version": "1.0.0"}'

# GUI åº”è¯¥ä¼šè‡ªåŠ¨å¯åŠ¨å¹¶æ˜¾ç¤ºè¿›åº¦
```

---

## ğŸ“Š åˆ†è¾¨ç‡é€‚é…æµ‹è¯•

### å½“å‰å±å¹•åˆ†è¾¨ç‡æ£€æŸ¥

```bash
xrandr | grep '*'
```

### ä¸åŒåˆ†è¾¨ç‡çš„é¢„æœŸæ•ˆæœ

| åˆ†è¾¨ç‡ | Logo å°ºå¯¸ | å­—ä½“å¤§å° | è¿›åº¦æ¡å®½åº¦ |
|--------|-----------|----------|-----------|
| 1920x440 | 100x100 | 36/28 | 1000px |
| 1024x600 | 80x80 | 28/20 | 500px |
| 1280x800 | 100x100 | 32/24 | 600px |
| 1920x1080 | 120x120 | 42/32 | 1000px |

---

## âš ï¸ æ•…éšœæ’é™¤

### é—®é¢˜ 1: çª—å£ä¸æ˜¾ç¤º

**æ£€æŸ¥**:
```bash
echo $DISPLAY  # åº”è¯¥è¾“å‡º :0 æˆ– :1
ps aux | grep X  # ç¡®è®¤ X server è¿è¡Œ
```

**è§£å†³**:
```bash
export DISPLAY=:1  # æˆ– :0
```

### é—®é¢˜ 2: SDL2 åˆå§‹åŒ–å¤±è´¥

**æ£€æŸ¥**:
```bash
# æµ‹è¯• SDL2
uv run python -c "import sdl2; print('SDL2 OK')"
```

**è§£å†³**:
```bash
sudo apt-get install --reinstall libsdl2-2.0-0
```

### é—®é¢˜ 3: å­—ä½“ä¸æ˜¾ç¤º

**æ£€æŸ¥**:
```bash
ls -lh src/updater/gui/fonts/
```

**è§£å†³**:
```bash
# é‡æ–°ä¸‹è½½å­—ä½“
wget -O src/updater/gui/fonts/NotoSansCJKsc-Regular.otf \
  https://github.com/googlefonts/noto-cjk/raw/main/Sans/OTF/SimplifiedChinese/NotoSansCJKsc-Regular.otf
```

### é—®é¢˜ 4: Logo ä¸æ˜¾ç¤º

**æ£€æŸ¥**:
```bash
ls -lh src/updater/gui/assets/logo_*.png
```

**è§£å†³**:
```bash
# é‡æ–°ç”Ÿæˆ logo
python scripts/convert_logo.py
```

---

## ğŸ“ æµ‹è¯•æ£€æŸ¥æ¸…å•

### åŠŸèƒ½æµ‹è¯•
- [ ] çª—å£æˆåŠŸåˆ›å»º
- [ ] Logo æ˜¾ç¤ºæ¸…æ™°
- [ ] ä¸­æ–‡æ–‡å­—æ­£å¸¸æ˜¾ç¤º
- [ ] è¿›åº¦æ¡å¹³æ»‘æ›´æ–°
- [ ] ç™¾åˆ†æ¯”æ­£ç¡®æ˜¾ç¤º
- [ ] å¸ƒå±€åˆç†ï¼ˆLogo å·¦ä¾§ï¼Œå†…å®¹å³ä¾§ï¼‰

### å…¨å±æµ‹è¯•
- [ ] å…¨å±è¦†ç›–æ•´ä¸ªå±å¹•
- [ ] çª—å£åœ¨æœ€å‰é¢
- [ ] å¯ä»¥æ­£å¸¸é€€å‡º

### æ€§èƒ½æµ‹è¯•
- [ ] å†…å­˜ä½¿ç”¨ < 50MB
- [ ] CPU ä½¿ç”¨ < 15%
- [ ] å¯åŠ¨æ—¶é—´ < 2 ç§’
- [ ] æ— å¡é¡¿æˆ–é—ªçƒ

### é›†æˆæµ‹è¯•
- [ ] GUI è‡ªåŠ¨å¯åŠ¨ï¼ˆè§¦å‘æ›´æ–°æ—¶ï¼‰
- [ ] è¿›åº¦å®æ—¶æ›´æ–°
- [ ] å®Œæˆåè‡ªåŠ¨å…³é—­
- [ ] ä¸å½±å“ updater ä¸»è¿›ç¨‹

---

## ğŸ“¸ æµ‹è¯•æˆªå›¾

æµ‹è¯•æ—¶è¯·æˆªå›¾ä»¥ä¸‹å†…å®¹ï¼š
1. çª—å£æ¨¡å¼æ˜¾ç¤ºæ•ˆæœ
2. å…¨å±æ¨¡å¼æ˜¾ç¤ºæ•ˆæœ
3. ä¸åŒè¿›åº¦é˜¶æ®µçš„æ˜¾ç¤º
4. ç»ˆç«¯è¾“å‡ºä¿¡æ¯

---

## ğŸ¯ é¢„æœŸæ€§èƒ½æŒ‡æ ‡

### Orange Pi 3B (RK3566)
- **å†…å­˜ä½¿ç”¨**: 30-40MB
- **CPU ä½¿ç”¨**: 5-10%
- **å¯åŠ¨æ—¶é—´**: < 1 ç§’
- **æ¸²æŸ“å¸§ç‡**: 20+ FPS

---

## ğŸ“ é—®é¢˜åé¦ˆ

å¦‚æœé‡åˆ°é—®é¢˜ï¼Œè¯·æä¾›ï¼š
1. é”™è¯¯ä¿¡æ¯ï¼ˆå®Œæ•´çš„ç»ˆç«¯è¾“å‡ºï¼‰
2. ç³»ç»Ÿä¿¡æ¯ï¼ˆ`uname -a`ï¼‰
3. SDL2 ç‰ˆæœ¬ï¼ˆ`dpkg -l | grep libsdl2`ï¼‰
4. å±å¹•åˆ†è¾¨ç‡ï¼ˆ`xrandr`ï¼‰
5. æµ‹è¯•æˆªå›¾

---

**æ–‡æ¡£ç‰ˆæœ¬**: 1.0  
**æœ€åæ›´æ–°**: 2026-01-29  
**é€‚ç”¨åˆ†æ”¯**: 002-gui
